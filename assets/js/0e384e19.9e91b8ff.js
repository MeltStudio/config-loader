"use strict";(self.webpackChunk_meltstudio_config_loader=self.webpackChunk_meltstudio_config_loader||[]).push([[976],{2053(e,n,r){r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>u,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"intro","title":"@meltstudio/config-loader","description":"A type-safe configuration loader for Node.js. Define your schema once, load from YAML or JSON files, .env files, environment variables, and CLI arguments \u2014 and get a fully typed result with zero manual type annotations.","source":"@site/docs/intro.md","sourceDirName":".","slug":"/","permalink":"/config-loader/","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"slug":"/","title":"@meltstudio/config-loader"}}');var s=r(4848),l=r(8453);const t={slug:"/",title:"@meltstudio/config-loader"},a="@meltstudio/config-loader",o={},c=[{value:"Why config-loader?",id:"why-config-loader",level:2},{value:"Features",id:"features",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Installation",id:"installation",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Schema API",id:"schema-api",level:2},{value:"Primitives",id:"primitives",level:3},{value:"Objects",id:"objects",level:3},{value:"Arrays",id:"arrays",level:3},{value:"Loading Sources",id:"loading-sources",level:2},{value:"Extended Loading (Source Metadata)",id:"extended-loading-source-metadata",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"CLI Arguments",id:"cli-arguments",level:2},{value:"Environment Variables",id:"environment-variables",level:2},{value:"<code>.env</code> File Support",id:"env-file-support",level:2},{value:"License",id:"license",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"meltstudioconfig-loader",children:"@meltstudio/config-loader"})}),"\n",(0,s.jsxs)(n.p,{children:["A type-safe configuration loader for Node.js. Define your schema once, load from YAML or JSON files, ",(0,s.jsx)(n.code,{children:".env"})," files, environment variables, and CLI arguments \u2014 and get a fully typed result with zero manual type annotations."]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Upgrading from v1?"})," v1.x is deprecated. v2 includes breaking changes to the public API, object schema syntax, and requires Node.js >= 20. Install the latest version with ",(0,s.jsx)(n.code,{children:"npm install @meltstudio/config-loader@latest"})," or ",(0,s.jsx)(n.code,{children:"yarn add @meltstudio/config-loader@latest"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"why-config-loader",children:"Why config-loader?"}),"\n",(0,s.jsxs)(n.p,{children:["Most config libraries give you ",(0,s.jsx)(n.code,{children:"Record<string, unknown>"})," and leave you to cast or validate manually. config-loader infers TypeScript types directly from your schema definition:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'import c from "@meltstudio/config-loader";\n\nconst config = c\n  .schema({\n    port: c.number({ required: true, env: "PORT" }),\n    database: c.object({\n      item: {\n        host: c.string({ required: true }),\n        credentials: c.object({\n          item: {\n            username: c.string(),\n            password: c.string({ env: "DB_PASSWORD" }),\n          },\n        }),\n      },\n    }),\n    features: c.array({\n      required: true,\n      item: c.object({\n        item: {\n          name: c.string(),\n          enabled: c.bool(),\n        },\n      }),\n    }),\n  })\n  .load({\n    env: true,\n    args: true,\n    files: "./config.yaml",\n  });\n\n// config is fully typed:\n// {\n//   port: number;\n//   database: { host: string; credentials: { username: string; password: string } };\n//   features: { name: string; enabled: boolean }[];\n// }\n'})}),"\n",(0,s.jsxs)(n.p,{children:["No separate interface to maintain. No ",(0,s.jsx)(n.code,{children:"as"})," casts. The types flow from the schema."]}),"\n",(0,s.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Full type inference"})," \u2014 schema definition produces typed output automatically"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Multiple sources"})," \u2014 YAML files, JSON files, ",(0,s.jsx)(n.code,{children:".env"})," files, environment variables, CLI arguments"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Priority resolution"})," \u2014 CLI > process.env > ",(0,s.jsx)(n.code,{children:".env"})," files > Config files > Defaults"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:[(0,s.jsx)(n.code,{children:".env"})," file support"]})," \u2014 load environment variables from ",(0,s.jsx)(n.code,{children:".env"})," files with automatic line tracking"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Nested objects and arrays"})," \u2014 deeply nested configs with full type safety"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Structured errors"})," \u2014 typed ",(0,s.jsx)(n.code,{children:"ConfigLoadError"})," with per-field error details instead of ",(0,s.jsx)(n.code,{children:"process.exit(1)"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Default values"})," \u2014 static or computed (via functions)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Multiple files / directory loading"})," \u2014 load from a list of files or an entire directory"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Node.js >= 20"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install @meltstudio/config-loader\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"yarn add @meltstudio/config-loader\n"})}),"\n",(0,s.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"config.yaml:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"version: 1.0.0\nwebsite:\n  title: My Website\n  description: A simple and elegant website\n  isProduction: false\n\ndatabase:\n  host: localhost\n  port: 5432\n  credentials:\n    username: admin\n    password: secret\n\nsocialMedia: [https://twitter.com/example, https://instagram.com/example]\n\nfeatures:\n  - name: Store\n    enabled: true\n  - name: Admin\n    enabled: false\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"index.ts:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'import path from "path";\nimport c from "@meltstudio/config-loader";\n\nconst config = c\n  .schema({\n    version: c.string({ required: true, cli: true }),\n    website: c.object({\n      item: {\n        title: c.string({ required: true }),\n        url: c.string({\n          required: false,\n          defaultValue: "www.mywebsite.dev",\n        }),\n        description: c.string({ required: true }),\n        isProduction: c.bool({ required: true }),\n      },\n    }),\n    database: c.object({\n      item: {\n        host: c.string({ required: true }),\n        port: c.number({ required: true }),\n        credentials: c.object({\n          item: {\n            username: c.string(),\n            password: c.string(),\n          },\n        }),\n      },\n    }),\n    socialMedia: c.array({\n      required: true,\n      item: c.string({ required: true }),\n    }),\n    features: c.array({\n      required: true,\n      item: c.object({\n        item: {\n          name: c.string(),\n          enabled: c.bool(),\n        },\n      }),\n    }),\n  })\n  .load({\n    env: false,\n    args: true,\n    files: path.join(__dirname, "./config.yaml"),\n  });\n\nconsole.log(JSON.stringify(config, null, 2));\n'})}),"\n",(0,s.jsx)(n.p,{children:"Output:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "version": "1.0.0",\n  "website": {\n    "title": "My Website",\n    "url": "www.mywebsite.dev",\n    "description": "A simple and elegant website",\n    "isProduction": false\n  },\n  "database": {\n    "host": "localhost",\n    "port": 5432,\n    "credentials": {\n      "username": "admin",\n      "password": "secret"\n    }\n  },\n  "socialMedia": [\n    "https://twitter.com/example",\n    "https://instagram.com/example"\n  ],\n  "features": [\n    { "name": "Store", "enabled": true },\n    { "name": "Admin", "enabled": false }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"schema-api",children:"Schema API"}),"\n",(0,s.jsx)(n.h3,{id:"primitives",children:"Primitives"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'c.string({\n  required: true,\n  env: "MY_VAR",\n  cli: true,\n  defaultValue: "fallback",\n});\nc.number({ required: true, env: "PORT" });\nc.bool({ env: "DEBUG", defaultValue: false });\n'})}),"\n",(0,s.jsx)(n.h3,{id:"objects",children:"Objects"}),"\n",(0,s.jsxs)(n.p,{children:["Use ",(0,s.jsx)(n.code,{children:"c.object()"})," to declare nested object schemas:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"c.object({\n  item: {\n    host: c.string(),\n    port: c.number(),\n  },\n});\n"})}),"\n",(0,s.jsx)(n.p,{children:"Objects can be nested arbitrarily deep:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'c.schema({\n  database: c.object({\n    item: {\n      host: c.string(),\n      port: c.number(),\n      credentials: c.object({\n        item: {\n          username: c.string(),\n          password: c.string({ env: "DB_PASSWORD" }),\n        },\n      }),\n    },\n  }),\n});\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"c.object()"})," accepts a ",(0,s.jsx)(n.code,{children:"required"})," option (defaults to ",(0,s.jsx)(n.code,{children:"false"}),"). When the entire subtree is absent from all sources, child ",(0,s.jsx)(n.code,{children:"required"})," options will trigger errors through normal validation."]}),"\n",(0,s.jsx)(n.h3,{id:"arrays",children:"Arrays"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"c.array({ required: true, item: c.string() }); // string[]\nc.array({ required: true, item: c.number() }); // number[]\nc.array({\n  item: c.object({\n    item: { name: c.string(), age: c.number() },\n  }),\n}); // { name: string; age: number }[]\n"})}),"\n",(0,s.jsx)(n.h2,{id:"loading-sources",children:"Loading Sources"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'.load({\n  env: true,          // Read from process.env\n  args: true,         // Read from CLI arguments (--database.port 3000)\n  files: "./config.yaml",                    // Single YAML file\n  files: "./config.json",                    // Single JSON file\n  files: ["./base.yaml", "./overrides.json"], // Mix YAML and JSON (first takes priority)\n  dir: "./config.d/",                        // All files in a directory (sorted)\n  envFile: "./.env",                         // Single .env file\n  envFile: ["./.env", "./.env.local"],       // Multiple .env files (later overrides earlier)\n  defaults: { port: 3000 },                  // Programmatic defaults\n})\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Both YAML (",(0,s.jsx)(n.code,{children:".yaml"}),", ",(0,s.jsx)(n.code,{children:".yml"}),") and JSON (",(0,s.jsx)(n.code,{children:".json"}),") files are supported. The format is detected automatically from the file extension."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Priority order:"})," CLI arguments > ",(0,s.jsx)(n.code,{children:"process.env"})," > ",(0,s.jsx)(n.code,{children:".env"})," files > Config files > Defaults"]}),"\n",(0,s.jsx)(n.h2,{id:"extended-loading-source-metadata",children:"Extended Loading (Source Metadata)"}),"\n",(0,s.jsxs)(n.p,{children:["Use ",(0,s.jsx)(n.code,{children:"loadExtended()"})," instead of ",(0,s.jsx)(n.code,{children:"load()"})," to get each value wrapped in a ",(0,s.jsx)(n.code,{children:"ConfigNode"})," that includes source metadata \u2014 where the value came from, which file, environment variable, or CLI argument provided it."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'import c from "@meltstudio/config-loader";\n\nconst extended = c\n  .schema({\n    port: c.number({ required: true, env: "PORT" }),\n    host: c.string({ defaultValue: "localhost" }),\n  })\n  .loadExtended({\n    env: true,\n    args: false,\n    files: "./config.yaml",\n  });\n\n// Each leaf is a ConfigNode with:\n// {\n//   value: 3000,\n//   path: "port",\n//   sourceType: "env" | "envFile" | "file" | "args" | "default",\n//   file: "./config.yaml" | "./.env" | null,\n//   variableName: "PORT" | null,\n//   argName: null,\n//   line: 5 | null,      // source line (1-based) for YAML, JSON, and .env files; null for env/args/default\n//   column: 3 | null      // source column (1-based) for YAML, JSON, and .env files; null for env/args/default\n// }\nconsole.log(extended.port.value); // 3000\nconsole.log(extended.port.sourceType); // "env"\nconsole.log(extended.port.variableName); // "PORT"\n'})}),"\n",(0,s.jsx)(n.p,{children:"This is useful for debugging configuration resolution, building admin UIs that show where each setting originated, or auditing which sources are active."}),"\n",(0,s.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,s.jsxs)(n.p,{children:["When validation fails, config-loader throws a ",(0,s.jsx)(n.code,{children:"ConfigLoadError"})," with structured error details:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'import c, { ConfigLoadError } from "@meltstudio/config-loader";\n\ntry {\n  const config = c.schema({ port: c.number({ required: true }) }).load({\n    env: false,\n    args: false,\n    files: "./config.yaml",\n  });\n} catch (err) {\n  if (err instanceof ConfigLoadError) {\n    for (const entry of err.errors) {\n      console.error(`[${entry.kind}] ${entry.message}`);\n      // e.g. [required] Required option \'port\' not provided.\n    }\n  }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"For CLI tools that prefer the old exit-on-error behavior:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'.load({ env: true, args: true, files: "./config.yaml", exitOnError: true })\n'})}),"\n",(0,s.jsx)(n.h2,{id:"cli-arguments",children:"CLI Arguments"}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:"cli: true"})," on an option to allow overriding via command line:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"c.schema({\n  version: c.string({ required: true, cli: true }),\n});\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"node app.js --version 2.0.0\n"})}),"\n",(0,s.jsx)(n.h2,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,s.jsxs)(n.p,{children:["Set ",(0,s.jsx)(n.code,{children:'env: "VAR_NAME"'})," on an option and ",(0,s.jsx)(n.code,{children:"env: true"})," in the load options:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'c.schema({\n  database: c.object({\n    item: {\n      password: c.string({ env: "DB_PASSWORD" }),\n    },\n  }),\n}).load({ env: true, args: false, files: "./config.yaml" });\n'})}),"\n",(0,s.jsxs)(n.h2,{id:"env-file-support",children:[(0,s.jsx)(n.code,{children:".env"})," File Support"]}),"\n",(0,s.jsxs)(n.p,{children:["Load environment variables from ",(0,s.jsx)(n.code,{children:".env"})," files using the ",(0,s.jsx)(n.code,{children:"envFile"})," option. Options with an ",(0,s.jsx)(n.code,{children:"env"})," mapping automatically pick up values from ",(0,s.jsx)(n.code,{children:".env"})," files \u2014 no new syntax needed on individual fields."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:".env:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"DB_HOST=localhost\nDB_PORT=5432\nDB_PASSWORD=\"s3cret\"\nAPP_NAME='My App'\n# This is a comment\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Usage:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const config = c\n  .schema({\n    host: c.string({ env: "DB_HOST" }),\n    port: c.number({ env: "DB_PORT" }),\n    password: c.string({ env: "DB_PASSWORD" }),\n  })\n  .load({\n    env: true,\n    args: false,\n    envFile: "./.env",\n  });\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"process.env"})," always takes precedence over ",(0,s.jsx)(n.code,{children:".env"})," file values. This means you can use ",(0,s.jsx)(n.code,{children:".env"})," files for development defaults while overriding them in production via real environment variables."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["Multiple ",(0,s.jsx)(n.code,{children:".env"})," files:"]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'.load({\n  env: true,\n  args: false,\n  envFile: ["./.env", "./.env.local"],  // .env.local overrides .env\n})\n'})}),"\n",(0,s.jsx)(n.p,{children:"When using multiple files, later files override earlier ones for the same key."}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:".env"})," parser supports:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"KEY=VALUE"})," pairs (whitespace trimmed)"]}),"\n",(0,s.jsxs)(n.li,{children:["Comments (lines starting with ",(0,s.jsx)(n.code,{children:"#"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["Quoted values (double ",(0,s.jsx)(n.code,{children:'"..."'})," or single ",(0,s.jsx)(n.code,{children:"'...'"})," quotes stripped)"]}),"\n",(0,s.jsxs)(n.li,{children:["Empty values (",(0,s.jsx)(n.code,{children:"KEY="}),")"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["When using ",(0,s.jsx)(n.code,{children:"loadExtended()"}),", values from ",(0,s.jsx)(n.code,{children:".env"})," files have ",(0,s.jsx)(n.code,{children:'sourceType: "envFile"'})," with ",(0,s.jsx)(n.code,{children:"file"}),", ",(0,s.jsx)(n.code,{children:"line"}),", and ",(0,s.jsx)(n.code,{children:"column"})," metadata pointing to the ",(0,s.jsx)(n.code,{children:".env"})," file location."]}),"\n",(0,s.jsx)(n.h2,{id:"license",children:"License"}),"\n",(0,s.jsxs)(n.p,{children:["This package is licensed under the Apache License 2.0. See the ",(0,s.jsx)(n.a,{href:"https://github.com/MeltStudio/config-loader/blob/main/LICENSE",children:"LICENSE"})," file for details."]})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,n,r){r.d(n,{R:()=>t,x:()=>a});var i=r(6540);const s={},l=i.createContext(s);function t(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);